<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>YES/NO(선택) 분기 웹페이지</title>
  <style>
:root{
  --bg:#ffffff;
  --card:#ffffff;
  --text:#111111;
  --muted:#6b7280;
  --border:#e5e7eb;

  --primary:#111111;
  --primaryHover:#000000;

  --btn:#ffffff;
  --btnHover:#f3f4f6;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family: -apple-system, BlinkMacSystemFont, "Apple SD Gothic Neo",
               "Noto Sans KR", "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height:100vh;
  display:flex;
  justify-content:center;
  padding:40px 24px;
}

/* 전체 폭 */
.wrap{
  width:100%;
  max-width:900px;
}

/* 상단 */
header{
  display:flex;
  justify-content:space-between;
  align-items:flex-end;
  margin-bottom:32px;
}

.title h1{
  margin:0;
  font-size:22px;
  font-weight:700;
}

.title p{
  margin:6px 0 0;
  font-size:14px;
  color:var(--muted);
}

/* STEP 표시 */
.pill{
  font-size:13px;
  padding:6px 12px;
  border:1px solid var(--border);
  border-radius:999px;
  color:var(--muted);
}

/* 카드 */
.card{
  border:1px solid var(--border);
  border-radius:12px;
  background:var(--card);
}

/* 질문 영역 */
.cardTop{
  padding:28px 28px 20px;
  border-bottom:1px solid var(--border);
  display:flex;
  justify-content:space-between;
  gap:16px;
}

.badge{
  font-size:12px;
  font-weight:600;
  color:var(--muted);
  margin-bottom:10px;
}

.qText{
  font-size:20px;
  font-weight:700;
  line-height:1.4;
}

/* 선택 버튼 */
.actions{
  padding:24px 28px;
  display:flex;
  gap:12px;
  flex-wrap:wrap;
}

button{
  appearance:none;
  border:1px solid var(--border);
  background:var(--btn);
  color:var(--text);
  padding:14px 18px;
  border-radius:8px;
  font-size:14px;
  font-weight:600;
  cursor:pointer;
  min-width:200px;
}

button:hover{
  background:var(--btnHover);
}

button.primary{
  background:var(--primary);
  color:#fff;
  border-color:var(--primary);
}

button.primary:hover{
  background:var(--primaryHover);
}

/* 하단 */
.footer{
  padding:16px 28px;
  border-top:1px solid var(--border);
  display:flex;
  justify-content:space-between;
  align-items:center;
  flex-wrap:wrap;
  gap:12px;
}

/* 선택 경로 */
.path{
  display:flex;
  gap:6px;
  flex-wrap:wrap;
}

.chip{
  font-size:12px;
  padding:4px 10px;
  border:1px solid var(--border);
  border-radius:999px;
  color:var(--muted);
  background:#fafafa;
}

/* 결과 */
.resultBox{
  padding:28px;
}

.resultCard{
  border:1px solid var(--border);
  border-radius:10px;
  padding:24px;
  background:#fafafa;
}

.resultTitle{
  font-size:13px;
  font-weight:600;
  color:var(--muted);
  margin-bottom:6px;
}

.resultValue{
  font-size:22px;
  font-weight:800;
}

.hint{
  margin-top:8px;
  font-size:13px;
  color:var(--muted);
}

/* 리셋/뒤로 */
button.ghost{
  background:#fff;
  color:var(--muted);
}

button.ghost:hover{
  background:#f9fafb;
}

button.danger{
  border:0;
  background:none;
  color:var(--muted);
  font-size:13px;
}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">
        <h1>분기형 설문(다이어그램 기반)</h1>
        <p>답변에 따라 다음 문항이 바뀌고, 최종 결과(추천)가 나옵니다.</p>
      </div>
      <div class="pill"><span class="dot"></span><span id="stepPill">STEP 1</span></div>
    </header>

    <section class="card" aria-live="polite">
      <div class="cardTop">
        <div class="q">
          <div class="badge" id="badge">질문</div>
          <div class="qText" id="qText">로딩중...</div>
        </div>
        <button class="danger" id="resetBtn" type="button" title="처음부터">리셋</button>
      </div>

      <div class="actions" id="actions"></div>

      <div class="resultBox" id="resultBox">
        <div class="resultCard">
          <div class="resultLeft">
            <div class="resultTitle">최종 결과</div>
            <div class="resultValue" id="resultValue"></div>
            <div class="hint" id="resultHint"></div>
          </div>
          <div style="display:flex; gap:8px; flex-wrap:wrap; align-items:center;">
            <button class="ghost" id="backBtn2" type="button">이전</button>
            <button class="primary" id="restartBtn" type="button">다시 하기</button>
          </div>
        </div>
      </div>

      <div class="footer">
        <div class="path" id="path"></div>
        <div style="display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
          <button class="ghost" id="backBtn" type="button">이전</button>
        </div>
      </div>
    </section>
  </div>

  <script>
    /**
     * 다이어그램(이미지) 기반 트리
     * - 첫 질문: 뜨끈한게 / 가볍게 (2지선다)
     * - 이후는 YES/NO 또는 좋아요/안땡겨요 등 2지선다
     */
    const TREE = {
      start: {
        type: "question",
        text: "어떻게 먹고 싶은가요?",
        options: [
          { label: "뜨끈한게", next: "hot_near" },
          { label: "가볍게", next: "light_near" }
        ]
      },

      // 뜨끈한게
      hot_near: {
        type: "question",
        text: "가까운 곳으로 가고 싶을까요?",
        options: [
          { label: "예", next: "hot_wait" },
          { label: "멀어도 좋아요", next: "hot_gukbab" }
        ]
      },
      hot_wait: {
        type: "question",
        text: "웨이팅이 있어도 괜찮아요?",
        options: [
          { label: "예", next: "hot_hangover" },
          { label: "아니오", next: "result_geuregeujip" }
        ]
      },
      hot_hangover: {
        type: "question",
        text: "해장이 필요하나요?",
        options: [
          { label: "예", next: "result_seolleongtang" },
          { label: "아니오", next: "result_poinviet" }
        ]
      },
      hot_gukbab: {
        type: "question",
        text: "국/밥이 있는 곳으로 갈까요?",
        options: [
          { label: "좋아요", next: "hot_deulseumbap" },
          { label: "안땡겨요", next: "hot_yukhoe" }
        ]
      },
      hot_deulseumbap: {
        type: "question",
        text: "들숨밥 어때요?",
        options: [
          { label: "좋아요", next: "result_bukchangdong" },
          { label: "안땡겨요", next: "hot_egg" }
        ]
      },
      hot_egg: {
        type: "question",
        text: "계란후라이 어때요?",
        options: [
          { label: "좋아요", next: "result_meogeodo" },
          { label: "안땡겨요", next: "result_igeum" }
        ]
      },
      hot_yukhoe: {
        type: "question",
        text: "육회비빔밥 어때요?",
        options: [
          { label: "좋아요", next: "result_yukhoe" },
          { label: "안땡겨요", next: "result_starve" }
        ]
      },

      // 가볍게
      light_near: {
        type: "question",
        text: "가까운 곳으로 가고 싶을까요?",
        options: [
          { label: "예", next: "light_poke_near" },
          { label: "멀어도 좋아요", next: "light_poke_far" }
        ]
      },
      light_poke_near: {
        type: "question",
        text: "포케 어때요?",
        options: [
          { label: "좋아요", next: "result_sallaria" },
          { label: "안땡겨요", next: "light_soup" }
        ]
      },
      light_soup: {
        type: "question",
        text: "스프 어때요?",
        options: [
          { label: "좋아요", next: "result_super" },
          { label: "안땡겨요", next: "light_sandwich" }
        ]
      },
      light_sandwich: {
        type: "question",
        text: "샌드위치 어때요?",
        options: [
          { label: "좋아요", next: "result_sallaria" },
          // 다이어그램에 '안땡겨요' 최종이 명확히 안 보이지만, 흐름상 굶으세요로 처리
          { label: "안땡겨요", next: "result_starve" }
        ]
      },
      light_poke_far: {
        type: "question",
        text: "포케 어때요?",
        options: [
          { label: "좋아요", next: "result_pokeplay" },
          { label: "안땡겨요", next: "result_starve" }
        ]
      },

      // 결과(터미널)
      result_seolleongtang: { type: "result", text: "신촌설렁탕/해장국" },
      result_poinviet:      { type: "result", text: "포인비에트" },
      result_geuregeujip:   { type: "result", text: "그래그집" },
      result_bukchangdong:  { type: "result", text: "북창동 순두부" },
      result_meogeodo:      { type: "result", text: "먹어도 되지" },
      result_igeum:         { type: "result", text: "이금" },
      result_yukhoe:        { type: "result", text: "육회집" },
      result_sallaria:      { type: "result", text: "샐러리아" },
      result_super:         { type: "result", text: "수퍼" },
      result_pokeplay:      { type: "result", text: "포케플레이" },
      result_starve:        { type: "result", text: "굶으세요" }
    };

    // ------- 상태/렌더링 -------
    const qText = document.getElementById("qText");
    const actions = document.getElementById("actions");
    const badge = document.getElementById("badge");
    const pathEl = document.getElementById("path");
    const stepPill = document.getElementById("stepPill");

    const resultBox = document.getElementById("resultBox");
    const resultValue = document.getElementById("resultValue");
    const resultHint = document.getElementById("resultHint");

    const resetBtn = document.getElementById("resetBtn");
    const backBtn = document.getElementById("backBtn");
    const backBtn2 = document.getElementById("backBtn2");
    const restartBtn = document.getElementById("restartBtn");

    // history: [{ nodeId, pickedLabel }]
    let current = "start";
    let history = [];

    function render(){
      const node = TREE[current];

      // step
      const step = history.length + 1;
      stepPill.textContent = `STEP ${step}`;

      // path chips
      pathEl.innerHTML = history.length
        ? history.map(h => `<span class="chip">${escapeHtml(h.pickedLabel)}</span>`).join("")
        : `<span class="chip">아직 선택 없음</span>`;

      // buttons
      actions.innerHTML = "";

      if(!node){
        badge.textContent = "오류";
        qText.textContent = "노드를 찾을 수 없어요. TREE 구성을 확인해주세요.";
        resultBox.style.display = "none";
        return;
      }

      if(node.type === "result"){
        badge.textContent = "결과";
        qText.textContent = "추천 결과가 나왔어요.";
        resultBox.style.display = "block";
        resultValue.textContent = node.text;

        const trail = history.map((h,i)=>`${i+1}) ${h.pickedLabel}`).join(" · ");
        resultHint.textContent = trail ? `선택 경로: ${trail}` : "";

        // 하단 액션(질문 버튼)은 숨김
        actions.innerHTML = "";
        return;
      }

      // question
      badge.textContent = "질문";
      qText.textContent = node.text;
      resultBox.style.display = "none";

      node.options.forEach(opt => {
        const btn = document.createElement("button");
        btn.type = "button";
        btn.textContent = opt.label;

        // 첫 질문만 강조
        if(current === "start") btn.classList.add("primary");

        btn.addEventListener("click", () => {
          history.push({ nodeId: current, pickedLabel: `${node.text} → ${opt.label}` });
          current = opt.next;
          render();
        });
        actions.appendChild(btn);
      });
    }

    function goBack(){
      if(history.length === 0){
        current = "start";
        render();
        return;
      }
      const prev = history.pop();
      current = prev.nodeId;
      render();
    }

    function resetAll(){
      current = "start";
      history = [];
      render();
    }

    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    resetBtn.addEventListener("click", resetAll);
    backBtn.addEventListener("click", goBack);
    backBtn2.addEventListener("click", goBack);
    restartBtn.addEventListener("click", resetAll);

    // init
    render();
  </script>
</body>
</html>
